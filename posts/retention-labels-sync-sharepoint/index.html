<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Sincronizar Etiquetas de retención a SharePoint manualmente. | JPCortesP</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="¿Qué son políticas de retención? Sirven para retener información por cierta cantidad de tiempo; la mejor forma de explicarlo es compartirles este link de la documentación.
¿Porqué las quiero en SharePoint? Fácil, funcionan para retener información. Un ejemplo podría ser:
Un documento en proceso es creado o cargado en SharePoint Un grupo de personas lo edita, y lo marcan como final. El dueño del documento, le aplica manualmente la etiqueta de retención llamada &ldquo;Retención 7 años&rdquo; El documento es retenido inmutable por 4 años Al término de 4 años, nos damos cuenta que es necesario editarlo."><meta name=generator content="Hugo 0.107.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Sincronizar Etiquetas de retención a SharePoint manualmente."><meta property="og:description" content="¿Qué son políticas de retención? Sirven para retener información por cierta cantidad de tiempo; la mejor forma de explicarlo es compartirles este link de la documentación.
¿Porqué las quiero en SharePoint? Fácil, funcionan para retener información. Un ejemplo podría ser:
Un documento en proceso es creado o cargado en SharePoint Un grupo de personas lo edita, y lo marcan como final. El dueño del documento, le aplica manualmente la etiqueta de retención llamada &ldquo;Retención 7 años&rdquo; El documento es retenido inmutable por 4 años Al término de 4 años, nos damos cuenta que es necesario editarlo."><meta property="og:type" content="article"><meta property="og:url" content="https://jpcortesp.github.io/posts/retention-labels-sync-sharepoint/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-24T20:51:06-06:00"><meta property="article:modified_time" content="2022-11-24T20:51:06-06:00"><meta itemprop=name content="Sincronizar Etiquetas de retención a SharePoint manualmente."><meta itemprop=description content="¿Qué son políticas de retención? Sirven para retener información por cierta cantidad de tiempo; la mejor forma de explicarlo es compartirles este link de la documentación.
¿Porqué las quiero en SharePoint? Fácil, funcionan para retener información. Un ejemplo podría ser:
Un documento en proceso es creado o cargado en SharePoint Un grupo de personas lo edita, y lo marcan como final. El dueño del documento, le aplica manualmente la etiqueta de retención llamada &ldquo;Retención 7 años&rdquo; El documento es retenido inmutable por 4 años Al término de 4 años, nos damos cuenta que es necesario editarlo."><meta itemprop=datePublished content="2022-11-24T20:51:06-06:00"><meta itemprop=dateModified content="2022-11-24T20:51:06-06:00"><meta itemprop=wordCount content="309"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Sincronizar Etiquetas de retención a SharePoint manualmente."><meta name=twitter:description content="¿Qué son políticas de retención? Sirven para retener información por cierta cantidad de tiempo; la mejor forma de explicarlo es compartirles este link de la documentación.
¿Porqué las quiero en SharePoint? Fácil, funcionan para retener información. Un ejemplo podría ser:
Un documento en proceso es creado o cargado en SharePoint Un grupo de personas lo edita, y lo marcan como final. El dueño del documento, le aplica manualmente la etiqueta de retención llamada &ldquo;Retención 7 años&rdquo; El documento es retenido inmutable por 4 años Al término de 4 años, nos damos cuenta que es necesario editarlo."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">JPCortesP</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Sincronizar Etiquetas de retención a SharePoint manualmente.</h1><time class="f6 mv4 dib tracked" datetime=2022-11-24T20:51:06-06:00>November 24, 2022</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id=qué-son-políticas-de-retención>¿Qué son políticas de retención?</h2><p>Sirven para retener información por cierta cantidad de tiempo; la mejor forma de explicarlo es compartirles este <a href="https://learn.microsoft.com/en-us/microsoft-365/compliance/retention-policies-sharepoint?view=o365-worldwide">link</a> de la documentación.</p><h2 id=porqué-las-quiero-en-sharepoint>¿Porqué las quiero en SharePoint?</h2><p>Fácil, funcionan para retener información. Un ejemplo podría ser:</p><ol><li>Un documento en proceso es creado o cargado en SharePoint</li><li>Un grupo de personas lo edita, y lo marcan como final.</li><li>El dueño del documento, le aplica manualmente la etiqueta de retención llamada <strong>&ldquo;Retención 7 años&rdquo;</strong></li><li>El documento es retenido inmutable por 4 años</li><li>Al término de 4 años, nos damos cuenta que es necesario editarlo.</li><li>Se genera una nueva versión, se mantiene la retención por 3 años más del original y 7 años para la segunda versión</li><li>Al final de la retención de ambas versiones, se eliminan automáticamente para reducir riesgo.</li></ol><p>Por supuesto hay muchos más ejemplos. La idea queda clara.</p><h2 id=porqué-hacer-un-post-sobre-algo-que-puede-ser-un-link-a-la-documentación>¿Porqué hacer un post sobre algo que puede ser un link a la documentación?</h2><p>Porque generalmente, luego de crear la etiqueta y publicarla siguiendo la <a href="https://learn.microsoft.com/en-us/microsoft-365/compliance/create-apply-retention-labels?view=o365-worldwide">documentación</a>, siempre puede pasar que varios dias después la etiqueta sigue sin estar disponible en SharePoint.</p><p>La documentación nos dice que podemos ejecutar <code>Set-RetentionCompliancePolicy -Identity &lt;policy name> -RetryDistribution</code> para sincronizar, sin embargo, si tenemos muchas, o hemos creado varias, se necesita una forma rápida de poder solicitar la sincronización manual de todas las políticas a la vez; si tenemos 20, son 20 ejecuciones y fácil nos toma horas. La forma rápida, abajo:</p><p><em>Como de Costumbre, es buena idea copiar y pegar en PowerShell ISE e ir paso a paso (Con F8) para capturar cualquier error</em></p><pre tabindex=0><code>$LabelsSharePoint = Get-RetentionCompliancePolicy 
foreach ($label in $LabelsSharePoint) {
    Set-RetentionCompliancePolicy -Identity $label.Name -RetryDistribution
    #Para mensajes privados de Teams, usar Set-AppRetentionCompliancePolicy -Identity $label.Name -RetryDistribution
    Write-host( $label.Name + &#34; se solicitó sincronizar&#34; ) -ForegroundColor Green
}
</code></pre><p>Para ver el Script completo, <strong>incluyendo la instalaciones y pre-requisitos</strong>, ir a este <a href=https://github.com/JPCortesP/JPCortesP.github.io/blob/main/static/scripts/Sync-retention-labels-sharepoint.ps1>link</a></p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://jpcortesp.github.io/>&copy; JPCortesP 2022</a><div><div class=ananke-socials></div></div></div></footer></body></html>